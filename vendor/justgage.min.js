JustGage=function(y){if(!y.id){alert("Missing id parameter for gauge!");return false}if(!document.getElementById(y.id)){alert('No element with id: "'+y.id+'" found!');return false}this.config={id:y.id,title:(y.title)?y.title:"",titleFontColor:(y.titleFontColor)?y.titleFontColor:"#999999",value:(y.value)?y.value:0,symbol:(y.symbol)?y.symbol:"",valueFontColor:(y.valueFontColor)?y.valueFontColor:"#010101",min:(y.min)?parseFloat(y.min):0,max:(y.max)?parseFloat(y.max):100,humanFriendlyDecimal:(y.humanFriendlyDecimal)?y.humanFriendlyDecimal:0,textRenderer:(y.textRenderer)?y.textRenderer:null,gaugeWidthScale:(y.gaugeWidthScale)?y.gaugeWidthScale:1,gaugeColor:(y.gaugeColor)?y.gaugeColor:"#edebeb",label:(y.label)?y.label:"",shadowOpacity:(y.shadowOpacity)?y.shadowOpacity:0.2,shadowSize:(y.shadowSize)?y.shadowSize:5,shadowVerticalOffset:(y.shadowVerticalOffset)?y.shadowVerticalOffset:3,levelColors:(y.levelColors)?y.levelColors:["#a9d70b","#f9c802","#ff0000"],labelFontColor:(y.labelFontColor)?y.labelFontColor:"#b3b3b3",startAnimationTime:(y.startAnimationTime)?y.startAnimationTime:700,startAnimationType:(y.startAnimationType)?y.startAnimationType:">",refreshAnimationTime:(y.refreshAnimationTime)?y.refreshAnimationTime:700,refreshAnimationType:(y.refreshAnimationType)?y.refreshAnimationType:">",donutStartAngle:(y.donutStartAngle)?y.donutStartAngle:90,valueMinFontSize:y.valueMinFontSize||16,titleMinFontSize:y.titleMinFontSize||10,labelMinFontSize:y.labelMinFontSize||10,minLabelMinFontSize:y.minLabelMinFontSize||10,maxLabelMinFontSize:y.maxLabelMinFontSize||10,hideValue:(y.hideValue)?y.hideValue:false,hideMinMax:(y.hideMinMax)?y.hideMinMax:false,hideInnerShadow:(y.hideInnerShadow)?y.hideInnerShadow:false,humanFriendly:(y.humanFriendly)?y.humanFriendly:false,noGradient:(y.noGradient)?y.noGradient:false,donut:(y.donut)?y.donut:false,relativeGaugeSize:(y.relativeGaugeSize)?y.relativeGaugeSize:false};var d,r,c,l,o,j,g,t,n,m,k,s,q,b,f,e,i,x,w,h,v,u;if(y.value>this.config.max){this.config.value=this.config.max}if(y.value<this.config.min){this.config.value=this.config.min}this.originalValue=y.value;this.canvas=Raphael(this.config.id,"100%","100%");if(this.config.relativeGaugeSize===true){this.canvas.setViewBox(0,0,200,150,true)}if(this.config.relativeGaugeSize===true){d=200;r=150}else{d=getStyle(document.getElementById(this.config.id),"width").slice(0,-2)*1;r=getStyle(document.getElementById(this.config.id),"height").slice(0,-2)*1}if(this.config.donut===true){if(d>r){l=r;c=l}else{if(d<r){c=d;l=c;if(l>r){o=l/r;l=l/o;c=l/o}}else{c=d;l=c}}j=(d-c)/2;g=(r-l)/2;t=((l/8)>10)?(l/10):10;n=j+c/2;m=g+l/11;k=((l/6.4)>16)?(l/5.4):18;s=j+c/2;if(this.config.label!==""){q=g+l/1.85}else{q=g+l/1.7}b=((l/16)>10)?(l/16):10;f=j+c/2;e=q+b;i=((l/16)>10)?(l/16):10;x=j+(c/10)+(c/6.666666666666667*this.config.gaugeWidthScale)/2;w=e;h=((l/16)>10)?(l/16):10;v=j+c-(c/10)-(c/6.666666666666667*this.config.gaugeWidthScale)/2;u=e}else{if(d>r){l=r;c=l*1.25;if(c>d){o=c/d;c=c/o;l=l/o}}else{if(d<r){c=d;l=c/1.25;if(l>r){o=l/r;l=l/o;c=l/o}}else{c=d;l=c*0.75}}j=(d-c)/2;g=(r-l)/2;t=((l/8)>this.config.titleMinFontSize)?(l/10):this.config.titleMinFontSize;n=j+c/2;m=g+l/6.4;k=((l/6.5)>this.config.valueMinFontSize)?(l/6.5):this.config.valueMinFontSize;s=j+c/2;q=g+l/1.275;b=((l/16)>this.config.labelMinFontSize)?(l/16):this.config.labelMinFontSize;f=j+c/2;e=q+k/2+5;i=((l/16)>this.config.minLabelMinFontSize)?(l/16):this.config.minLabelMinFontSize;x=j+(c/10)+(c/6.666666666666667*this.config.gaugeWidthScale)/2;w=e;h=((l/16)>this.config.maxLabelMinFontSize)?(l/16):this.config.maxLabelMinFontSize;v=j+c-(c/10)-(c/6.666666666666667*this.config.gaugeWidthScale)/2;u=e}this.params={canvasW:d,canvasH:r,widgetW:c,widgetH:l,dx:j,dy:g,titleFontSize:t,titleX:n,titleY:m,valueFontSize:k,valueX:s,valueY:q,labelFontSize:b,labelX:f,labelY:e,minFontSize:i,minX:x,minY:w,maxFontSize:h,maxX:v,maxY:u};d,r,c,l,o,j,g,t,n,m,k,s,q,b,f,e,i,x,w,h,v,u=null;this.canvas.customAttributes.pki=function(M,N,P,G,Q,H,F,z,E){var C,I,L,D,B,J,R,O,A,K;if(E){C=(1-2*(M-N)/(P-N))*Math.PI;I=G/2-G/7;L=I-G/6.666666666666667*z;D=G/2+H;B=Q/1.95+F;J=G/2+H+I*Math.cos(C);R=Q-(Q-B)+0-I*Math.sin(C);O=G/2+H+L*Math.cos(C);A=Q-(Q-B)+0-L*Math.sin(C);K+="M"+(D-L)+","+B+" ";K+="L"+(D-I)+","+B+" ";if(M>((P-N)/2)){K+="A"+I+","+I+" 0 0 1 "+(D+I)+","+B+" "}K+="A"+I+","+I+" 0 0 1 "+J+","+R+" ";K+="L"+O+","+A+" ";if(M>((P-N)/2)){K+="A"+L+","+L+" 0 0 0 "+(D+L)+","+B+" "}K+="A"+L+","+L+" 0 0 0 "+(D-L)+","+B+" ";K+="Z ";return{path:K}}else{C=(1-(M-N)/(P-N))*Math.PI;I=G/2-G/10;L=I-G/6.666666666666667*z;D=G/2+H;B=Q/1.25+F;J=G/2+H+I*Math.cos(C);R=Q-(Q-B)+0-I*Math.sin(C);O=G/2+H+L*Math.cos(C);A=Q-(Q-B)+0-L*Math.sin(C);K+="M"+(D-L)+","+B+" ";K+="L"+(D-I)+","+B+" ";K+="A"+I+","+I+" 0 0 1 "+J+","+R+" ";K+="L"+O+","+A+" ";K+="A"+L+","+L+" 0 0 0 "+(D-L)+","+B+" ";K+="Z ";return{path:K}}C,I,L,D,B,J,R,O,A,K=null};this.gauge=this.canvas.path().attr({stroke:"none",fill:this.config.gaugeColor,pki:[this.config.max,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale,this.config.donut]});this.gauge.id=this.config.id+"-gauge";this.level=this.canvas.path().attr({stroke:"none",fill:getColorForPercentage((this.config.value-this.config.min)/(this.config.max-this.config.min),this.config.levelColors,this.config.noGradient),pki:[this.config.min,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale,this.config.donut]});if(this.config.donut){this.level.transform("r"+this.config.donutStartAngle+", "+(this.params.widgetW/2+this.params.dx)+", "+(this.params.widgetH/1.95+this.params.dy))}this.level.id=this.config.id+"-level";this.txtTitle=this.canvas.text(this.params.titleX,this.params.titleY,this.config.title);this.txtTitle.attr({"font-size":this.params.titleFontSize,"font-weight":"bold","font-family":"Arial",fill:this.config.titleFontColor,"fill-opacity":"1"});setDy(this.txtTitle,this.params.titleFontSize,this.params.titleY);this.txtTitle.id=this.config.id+"-txttitle";if(this.config.textRenderer){this.originalValue=this.config.textRenderer(this.originalValue)}else{if(this.config.humanFriendly){this.originalValue=humanFriendlyNumber(this.originalValue,this.config.humanFriendlyDecimal)+this.config.symbol}else{this.originalValue+=this.config.symbol}}this.txtValue=this.canvas.text(this.params.valueX,this.params.valueY,this.originalValue);this.txtValue.attr({"font-size":this.params.valueFontSize,"font-weight":"bold","font-family":"Arial",fill:this.config.valueFontColor,"fill-opacity":"0"});setDy(this.txtValue,this.params.valueFontSize,this.params.valueY);this.txtValue.id=this.config.id+"-txtvalue";this.txtLabel=this.canvas.text(this.params.labelX,this.params.labelY,this.config.label);this.txtLabel.attr({"font-size":this.params.labelFontSize,"font-weight":"normal","font-family":"Arial",fill:this.config.labelFontColor,"fill-opacity":"0"});setDy(this.txtLabel,this.params.labelFontSize,this.params.labelY);this.txtLabel.id=this.config.id+"-txtlabel";this.txtMinimum=this.config.min;if(this.config.humanFriendly){this.txtMinimum=humanFriendlyNumber(this.config.min,this.config.humanFriendlyDecimal)}this.txtMin=this.canvas.text(this.params.minX,this.params.minY,this.txtMinimum);this.txtMin.attr({"font-size":this.params.minFontSize,"font-weight":"normal","font-family":"Arial",fill:this.config.labelFontColor,"fill-opacity":(this.config.hideMinMax||this.config.donut)?"0":"1"});setDy(this.txtMin,this.params.minFontSize,this.params.minY);this.txtMin.id=this.config.id+"-txtmin";this.txtMaximum=this.config.max;if(this.config.humanFriendly){this.txtMaximum=humanFriendlyNumber(this.config.max,this.config.humanFriendlyDecimal)}this.txtMax=this.canvas.text(this.params.maxX,this.params.maxY,this.txtMaximum);this.txtMax.attr({"font-size":this.params.maxFontSize,"font-weight":"normal","font-family":"Arial",fill:this.config.labelFontColor,"fill-opacity":(this.config.hideMinMax||this.config.donut)?"0":"1"});setDy(this.txtMax,this.params.maxFontSize,this.params.maxY);this.txtMax.id=this.config.id+"-txtmax";var a=this.canvas.canvas.childNodes[1];var p="http://www.w3.org/2000/svg";if(ie<9){onCreateElementNsReady(function(){this.generateShadow()})}else{this.generateShadow(p,a)}a,p=null;this.level.animate({pki:[this.config.value,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale,this.config.donut]},this.config.startAnimationTime,this.config.startAnimationType);if(!this.config.hideValue){this.txtValue.animate({"fill-opacity":"1"},this.config.startAnimationTime,this.config.startAnimationType)}this.txtLabel.animate({"fill-opacity":"1"},this.config.startAnimationTime,this.config.startAnimationType)};JustGage.prototype.refresh=function(d){var a,c,b;a=d;c=d;if(d>this.config.max){d=this.config.max}if(d<this.config.min){d=this.config.min}b=getColorForPercentage((d-this.config.min)/(this.config.max-this.config.min),this.config.levelColors,this.config.noGradient);if(this.config.textRenderer){c=this.config.textRenderer(c)}else{if(this.config.humanFriendly){c=humanFriendlyNumber(c,this.config.humanFriendlyDecimal)+this.config.symbol}else{c+=this.config.symbol}}this.canvas.getById(this.config.id+"-txtvalue").attr({text:c});setDy(this.canvas.getById(this.config.id+"-txtvalue"),this.params.valueFontSize,this.params.valueY);this.canvas.getById(this.config.id+"-level").animate({pki:[d,this.config.min,this.config.max,this.params.widgetW,this.params.widgetH,this.params.dx,this.params.dy,this.config.gaugeWidthScale,this.config.donut],fill:b},this.config.refreshAnimationTime,this.config.refreshAnimationType);this.config.value=d;a,c,b=null};JustGage.prototype.generateShadow=function(f,e){var h,i,g,d,c,b,a;h=document.createElementNS(f,"filter");h.setAttribute("id",this.config.id+"-inner-shadow");e.appendChild(h);i=document.createElementNS(f,"feOffset");i.setAttribute("dx",0);i.setAttribute("dy",this.config.shadowVerticalOffset);h.appendChild(i);g=document.createElementNS(f,"feGaussianBlur");g.setAttribute("result","offset-blur");g.setAttribute("stdDeviation",this.config.shadowSize);h.appendChild(g);d=document.createElementNS(f,"feComposite");d.setAttribute("operator","out");d.setAttribute("in","SourceGraphic");d.setAttribute("in2","offset-blur");d.setAttribute("result","inverse");h.appendChild(d);c=document.createElementNS(f,"feFlood");c.setAttribute("flood-color","black");c.setAttribute("flood-opacity",this.config.shadowOpacity);c.setAttribute("result","color");h.appendChild(c);b=document.createElementNS(f,"feComposite");b.setAttribute("operator","in");b.setAttribute("in","color");b.setAttribute("in2","inverse");b.setAttribute("result","shadow");h.appendChild(b);a=document.createElementNS(f,"feComposite");a.setAttribute("operator","over");a.setAttribute("in","shadow");a.setAttribute("in2","SourceGraphic");h.appendChild(a);if(!this.config.hideInnerShadow){this.canvas.canvas.childNodes[2].setAttribute("filter","url(#"+this.config.id+"-inner-shadow)");this.canvas.canvas.childNodes[3].setAttribute("filter","url(#"+this.config.id+"-inner-shadow)")}h,i,g,d,c,b,a=null};function getColorForPercentage(c,d,a){var b,f,g,h,t,e,l,s,q,k,m,u,r,n;b=d.length;if(b===1){return d[0]}f=(a)?(1/b):(1/(b-1));g=[];for(var p=0;p<d.length;p++){h=(a)?(f*(p+1)):(f*p);t=parseInt((cutHex(d[p])).substring(0,2),16);e=parseInt((cutHex(d[p])).substring(2,4),16);l=parseInt((cutHex(d[p])).substring(4,6),16);g[p]={pct:h,color:{r:t,g:e,b:l}}}if(c===0){return"rgb("+[g[0].color.r,g[0].color.g,g[0].color.b].join(",")+")"}for(var o=0;o<g.length;o++){if(c<=g[o].pct){if(a){return"rgb("+[g[o].color.r,g[o].color.g,g[o].color.b].join(",")+")"}else{s=g[o-1];q=g[o];k=q.pct-s.pct;m=(c-s.pct)/k;u=1-m;r=m;n={r:Math.floor(s.color.r*u+q.color.r*r),g:Math.floor(s.color.g*u+q.color.g*r),b:Math.floor(s.color.b*u+q.color.b*r)};return"rgb("+[n.r,n.g,n.b].join(",")+")"}}}}function setDy(b,c,a){b.node.firstChild.attributes.dy.value=0}function getRandomInt(b,a){return Math.floor(Math.random()*(a-b+1))+b}function cutHex(a){return(a.charAt(0)=="#")?a.substring(1,7):a}function humanFriendlyNumber(g,f){var e,c,a,b;e=Math.pow;c=e(10,f);a=7;while(a){b=e(10,a--*3);if(b<=g){g=Math.round(g*c/b)/c+"kMGTPE"[a]}}return g}function getStyle(a,b){var c="";if(document.defaultView&&document.defaultView.getComputedStyle){c=document.defaultView.getComputedStyle(a,"").getPropertyValue(b)}else{if(a.currentStyle){b=b.replace(/\-(\w)/g,function(d,e){return e.toUpperCase()});c=a.currentStyle[b]}}return c}function onCreateElementNsReady(a){if(document.createElementNS!==undefined){a()}else{setTimeout(function(){onCreateElementNsReady(a)},100)}}var ie=(function(){var c,a=3,d=document.createElement("div"),b=d.getElementsByTagName("i");while(d.innerHTML="<!--[if gt IE "+(++a)+"]><i></i><![endif]-->",b[0]){}return a>4?a:c}());